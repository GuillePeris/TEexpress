% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TE_genomic_context.R
\name{TE_genomic_context}
\alias{TE_genomic_context}
\title{Annotate TEs with Genomic Context Relative to Genes}
\usage{
TE_genomic_context(
  df.TEs,
  gene.TxDb,
  gene_names,
  transcript.gr,
  TSSminus = -5000,
  TSSplus = 5000,
  downstream = 10000
)
}
\arguments{
\item{df.TEs}{Data frame containing TE loci with genomic coordinates.
Must include columns: \code{seqnames}, \code{start}, \code{end}, and
\code{strand}. Typically the output from differential expression analysis.}

\item{gene.TxDb}{A TxDb object containing gene/transcript annotations.
Can be created from GTF files using \code{GenomicFeatures::makeTxDbFromGFF}
or loaded from Bioconductor annotation packages.}

\item{gene_names}{Data frame mapping gene IDs to gene names. Must contain
columns: \code{gene_id} (matching IDs in TxDb) and \code{gene_name}
(human-readable gene symbols). Used to add gene names to final output.}

\item{transcript.gr}{GRanges object containing transcript annotations. Must
include a \code{gene_id} column in metadata. Used for assigning the nearest
gene to intergenic TEs. Typically obtained by filtering a gene GTF for
entries where \code{type == "transcript"}.}

\item{TSSminus}{Integer. Number of bases upstream of TSS to define promoter
region. Should be negative. Default is -5000 (5kb upstream).}

\item{TSSplus}{Integer. Number of bases downstream of TSS to define promoter
region. Should be positive. Default is 5000 (5kb downstream).}

\item{downstream}{Integer. Maximum distance downstream of gene end to
consider for "Downstream" annotation. Default is 10000 (10kb).}
}
\value{
Data frame combining original TE information with genomic annotation
columns:
\describe{
\item{annotation}{Simplified genomic context (Promoter, 5' UTR, Exon,
Intron, 3' UTR, Downstream, Intergenic)}
\item{geneChr, geneStart, geneEnd, geneLength, geneStrand}{Genomic
coordinates of the associated gene}
\item{geneId}{Gene identifier from the TxDb}
\item{gene_name}{Human-readable gene symbol (if available in gene_names)}
\item{distanceToTSS}{Distance to transcription start site (from ChIPseeker)}
}
}
\description{
Annotates transposable element (TE) loci with their genomic context relative
to protein-coding genes. Uses ChIPseeker to determine if TEs overlap
promoters, exons, introns, UTRs, or intergenic regions. Assigns the nearest
gene to intergenic TEs.
}
\details{
The function performs genomic annotation in several steps:
\enumerate{
\item Converts TE data frame to GRanges object
\item Annotates TEs using ChIPseeker with priority to coding regions
\item Simplifies annotation categories (e.g., "Exon (uc057wby.1/267097, exon 2 of 7)"
becomes "Exon")
\item For intergenic TEs, assigns the nearest transcript from \code{transcript.gr}
\item Adds gene names from the provided mapping table
}

Annotation priorities (from highest to lowest):
5' UTR → 3' UTR → Exon → Promoter → Intron → Downstream → Intergenic

Note: ChIPseeker may internally convert UCSC chromosome naming (chr1) to
NCBI style (1). This function converts them back to UCSC format for consistency.
}
\examples{
\dontrun{
# Annotate TEs (assuming TE_results from TE_DEA)
TE_annotated <- TE_genomic_context(
  df.TEs = TE_results$res.TEs,
  gene.TxDb = txdb,
  gene_names = gene_names,
  transcript.gr = transcript.gr,
  TSSminus = -3000,
  TSSplus = 3000
)
}

}
