% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/graphTEregion.R
\name{graphTEregion}
\alias{graphTEregion}
\title{Generate Genomic Region and TE Class Distribution Plots}
\usage{
graphTEregion(
  TE_results,
  device = "png",
  output_folder = ".",
  width = 10,
  height = 7,
  minCounts = 10,
  minlfc = 1,
  maxpadj = 0.05,
  plot.title = NULL
)
}
\arguments{
\item{TE_results}{List object returned by \code{\link{TE_DEA}} and annotated
by \code{\link{annotate_TE_regions}}, containing:
\describe{
\item{res.TEs}{Data frame of DESeq2 results with genomic annotations.
Must include columns: \code{log2FoldChange}, \code{padj},
\code{annotation}, \code{TE_class}}
\item{TE.count}{Data frame of normalized counts with genomic annotations.
Columns should be sample names plus annotation columns}
\item{metadata}{Sample metadata with columns: \code{Sample},
\code{Condition}}
}}

\item{device}{Character vector. File format(s) for output plots. Supported:
"svg", "eps", "png", "tiff", "jpeg". Can specify multiple formats.
Default is "png".}

\item{output_folder}{Character string. Directory where plots will be saved.
Default is current directory (".").}

\item{width}{Numeric. Plot width in inches. Default is 10.}

\item{height}{Numeric. Plot height in inches. Default is 7.}

\item{minCounts}{Numeric. Minimum total normalized counts threshold for
considering a TE "expressed" in a condition. TEs below this threshold
across all samples in a condition are excluded. Default is 10.}

\item{minlfc}{Numeric. Minimum absolute log2 fold change for defining
up/down-regulated TEs. Default is 1.}

\item{maxpadj}{Numeric. Maximum adjusted p-value for defining significant
differential expression. Default is 0.05.}

\item{plot.title}{Character string. Title for the plots. If NULL, no title
is added. Default is NULL.}
}
\value{
Invisible NULL. Called for side effects (creating plot files).
}
\description{
Creates stacked bar plots showing the distribution of transposable elements
across genomic regions (promoters, exons, introns, etc.) and TE classes
(LINE, SINE, LTR, DNA) for different sample groups and differential
expression categories.
}
\details{
The function generates two types of stacked bar plots:
\enumerate{
\item Genomic Region Distribution: Shows percentage of TEs in each genomic
context (Promoter, 5' UTR, Exon, Intron, 3' UTR, Downstream, Intergenic)
\item TE Class Distribution: Shows percentage of different TE classes
(LINE, SINE, LTR, DNA, Other)
}

Four categories are plotted for each:
\itemize{
\item Control: TEs expressed (total counts > minCounts) in control samples
\item Treatment: TEs expressed in treatment samples
\item Down: Significantly down-regulated TEs (log2FC < -minlfc, padj < maxpadj)
\item Up: Significantly up-regulated TEs (log2FC > minlfc, padj < maxpadj)
}

Sample group names are derived from the common prefix of sample names in
each condition (e.g., "WT1, WT2, WT3" becomes "WT").
}
\section{Output Files}{

Two plot files are created in the specified format(s):
\itemize{
\item \code{stackBar_region.<format>}: Genomic region distribution
\item \code{stackBar_TEclass.<format>}: TE class distribution
}
}

\examples{
\dontrun{
# After running TE_DEA and TE_regionAnnot
TE_results <- TE_DEA(
  metafile = "metadata.txt",
  folder = "counts",
  gtf.TE.file = "TEs.gtf"
)

TE_results <- TE_regionAnnot(
  TE_results = TE_results,
  gtf.genes.file = "genes.gtf"
)

# Generate region distribution plots
graphTEregion(
  TE_results = TE_results,
  device = c("tiff", "png"),
  output_folder = "results/plots",
  width = 10,
  height = 7,
  minCounts = 10,
  minlfc = 1,
  maxpadj = 0.05,
  plot.title = "TE Distribution"
)
}

}
